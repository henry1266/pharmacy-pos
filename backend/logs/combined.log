{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m執行科目統計聚合查詢\u001b[39m","timestamp":"2025-08-11 08:36:43:3643"}
{"executionTime":"7ms","level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m聚合查詢完成\u001b[39m","resultCount":43,"timestamp":"2025-08-11 08:36:43:3643"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m執行科目統計聚合查詢\u001b[39m","timestamp":"2025-08-11 08:36:43:3643"}
{"executionTime":"6ms","level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m聚合查詢完成\u001b[39m","resultCount":43,"timestamp":"2025-08-11 08:36:43:3643"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m執行科目統計聚合查詢\u001b[39m","timestamp":"2025-08-11 08:36:43:3643"}
{"executionTime":"6ms","level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m聚合查詢完成\u001b[39m","resultCount":43,"timestamp":"2025-08-11 08:36:43:3643"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m執行科目統計聚合查詢\u001b[39m","timestamp":"2025-08-11 08:36:43:3643"}
{"executionTime":"6ms","level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m聚合查詢完成\u001b[39m","resultCount":43,"timestamp":"2025-08-11 08:36:43:3643"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 10:41:20:4120"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 10:41:20:4120"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m檢查產品ID: 67ee04d18b015c0b28783d97, 名稱: ⊕BROWN MIXTURE 120ML 甘草止咳藥水\u001b[39m","timestamp":"2025-08-11 10:41:54:4154"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到 12 個庫存記錄\u001b[39m","timestamp":"2025-08-11 10:41:54:4154"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 67f35ad63d950f027060639b, 類型: purchase, 數量: 2\u001b[39m","timestamp":"2025-08-11 10:41:54:4154"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 67f394e0babaff09d4956cea, 類型: purchase, 數量: 2\u001b[39m","timestamp":"2025-08-11 10:41:54:4154"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 67f39c13babaff09d495977e, 類型: purchase, 數量: 3\u001b[39m","timestamp":"2025-08-11 10:41:54:4154"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 67f39ce6babaff09d495bc7e, 類型: purchase, 數量: 6\u001b[39m","timestamp":"2025-08-11 10:41:54:4154"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 67fe06b3c2347c64b939eb7a, 類型: sale, 數量: -1\u001b[39m","timestamp":"2025-08-11 10:41:54:4154"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 67fe0706c2347c64b939eb96, 類型: sale, 數量: -1\u001b[39m","timestamp":"2025-08-11 10:41:54:4154"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 67fe15fbc2347c64b93a0f16, 類型: sale, 數量: -1\u001b[39m","timestamp":"2025-08-11 10:41:54:4154"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 67fe175ec2347c64b93a0f9f, 類型: sale, 數量: -1\u001b[39m","timestamp":"2025-08-11 10:41:54:4154"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 67fe1b57c2347c64b93a1b15, 類型: sale, 數量: -1\u001b[39m","timestamp":"2025-08-11 10:41:54:4154"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 67fe1bf9c2347c64b93a1b48, 類型: sale, 數量: -1\u001b[39m","timestamp":"2025-08-11 10:41:54:4154"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 684a24c4c6862fc2a3008e2a, 類型: ship, 數量: -1\u001b[39m","timestamp":"2025-08-11 10:41:54:4154"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688431979e9da050c10ebe93, 類型: ship, 數量: -1\u001b[39m","timestamp":"2025-08-11 10:41:54:4154"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m產品 ⊕BROWN MIXTURE 120ML 甘草止咳藥水 總庫存量: 5，銷售數量: 1\u001b[39m","timestamp":"2025-08-11 10:41:54:4154"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m使用前端提供的銷貨單號: \"20250811366\"\u001b[39m","timestamp":"2025-08-11 10:41:54:4154"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m為產品 67ee04d18b015c0b28783d97 創建銷售庫存記錄，數量: -1, 總金額: 80\u001b[39m","timestamp":"2025-08-11 10:41:54:4154"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m檢查產品ID: 67eb60d00f2cf9d2647e3cfc, 名稱: SOLACON 200MG 舒可樂\u001b[39m","timestamp":"2025-08-11 10:54:58:5458"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到 8 個庫存記錄\u001b[39m","timestamp":"2025-08-11 10:54:58:5458"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 67ff10c68cd383dad08f1c70, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 10:54:58:5458"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 6835a3244160de5e80700319, 類型: ship, 數量: -1000\u001b[39m","timestamp":"2025-08-11 10:54:58:5458"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 6847c445160937f08a019888, 類型: sale, 數量: -9\u001b[39m","timestamp":"2025-08-11 10:54:58:5458"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 687dafa85d7e991f62c55aaf, 類型: sale, 數量: -10\u001b[39m","timestamp":"2025-08-11 10:54:58:5458"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688b2a2d9593bdf46678b73f, 類型: ship, 數量: -1981\u001b[39m","timestamp":"2025-08-11 10:54:58:5458"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688f38b9b97820e894c94e5e, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 10:54:58:5458"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688f76c050daca5a7cb94508, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 10:54:58:5458"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 68907e78a2b9045eb2dcc65f, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 10:54:58:5458"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m產品 SOLACON 200MG 舒可樂 總庫存量: 1000，銷售數量: 34\u001b[39m","timestamp":"2025-08-11 10:54:58:5458"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m使用前端提供的銷貨單號: \"20250811242\"\u001b[39m","timestamp":"2025-08-11 10:54:58:5458"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m為產品 67eb60d00f2cf9d2647e3cfc 創建銷售庫存記錄，數量: -34, 總金額: 100\u001b[39m","timestamp":"2025-08-11 10:54:58:5458"}
{"count":549,"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m批量檢查進貨單付款狀態開始\u001b[39m","timestamp":"2025-08-11 11:34:53:3453"}
{"hasPaymentCount":92,"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m批量付款狀態檢查完成\u001b[39m","missingPaymentCount":59,"missingTransactionIdCount":398,"paymentTransactionsCount":27,"timestamp":"2025-08-11 11:34:53:3453","totalOrders":549}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m批量付款狀態檢查結果\u001b[39m","paidCount":92,"timestamp":"2025-08-11 11:34:53:3453","totalCount":549,"unpaidCount":457}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37mGET /api/supplier-account-mappings 查詢參數:\u001b[39m","query":{"supplierId":"67e4df4aa6f9d4c76b0461d0"},"supplierId":"67e4df4aa6f9d4c76b0461d0","timestamp":"2025-08-11 11:36:29:3629"}
{"count":1,"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m查詢結果:\u001b[39m","timestamp":"2025-08-11 11:36:29:3629"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 11:47:37:4737"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 11:47:37:4737"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 12:01:03:13"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 12:01:03:13"}
{"0":"688209408961594c0bc0068b","1":"6881ede993a4e6567f1de484","level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m創建進貨單 - selectedAccountIds:\u001b[39m","timestamp":"2025-08-11 12:02:31:231"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m創建進貨單 - items:\u001b[39m","timestamp":"2025-08-11 12:02:31:231"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m創建進貨單 - processedItems:\u001b[39m","timestamp":"2025-08-11 12:02:31:231"}
{"0":"688209408961594c0bc0068b","1":"6881ede993a4e6567f1de484","level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m進貨單已儲存 - selectedAccountIds:\u001b[39m","timestamp":"2025-08-11 12:02:31:231"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m已為產品 685f371e620934c0f5e5f6d5 創建新庫存記錄，進貨單號: 20250811001, 數量: 100, 總金額: 100\u001b[39m","timestamp":"2025-08-11 12:02:31:231"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m已為產品 67edfc758b015c0b28783b1d 創建新庫存記錄，進貨單號: 20250811001, 數量: 56, 總金額: 300\u001b[39m","timestamp":"2025-08-11 12:02:31:231"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m已為產品 67edfc758b015c0b28783aff 創建新庫存記錄，進貨單號: 20250811001, 數量: 60, 總金額: 212\u001b[39m","timestamp":"2025-08-11 12:02:31:231"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m已為產品 67ee5111be3683bc98fb45ee 創建新庫存記錄，進貨單號: 20250811001, 數量: 20, 總金額: 800\u001b[39m","timestamp":"2025-08-11 12:02:31:231"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m已為產品 67eb60d00f2cf9d2647e3ced 創建新庫存記錄，進貨單號: 20250811001, 數量: 2000, 總金額: 1800\u001b[39m","timestamp":"2025-08-11 12:02:31:231"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m已為產品 67ee2fb8c047658bac63b177 創建新庫存記錄，進貨單號: 20250811001, 數量: 200, 總金額: 350\u001b[39m","timestamp":"2025-08-11 12:02:31:231"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m檢查進貨單自動會計分錄條件:\u001b[39m","poid":"20250811001","timestamp":"2025-08-11 12:02:31:231"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m進貨單沒有機構ID，將嘗試從會計科目獲取\u001b[39m","timestamp":"2025-08-11 12:02:31:231"}
{"accountCount":2,"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m滿足自動會計分錄條件:\u001b[39m","organizationId":"未設置","timestamp":"2025-08-11 12:02:31:231","totalAmount":3562}
{"asset":true,"expense":false,"level":"\u001b[37mdebug\u001b[39m","liability":true,"message":"\u001b[37m科目類型分析:\u001b[39m","timestamp":"2025-08-11 12:02:31:231"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m判斷為資產-負債格式: 資產科目 + 負債科目\u001b[39m","timestamp":"2025-08-11 12:02:31:231"}
{"entryType":"asset-liability","level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m自動推斷分錄類型:\u001b[39m","timestamp":"2025-08-11 12:02:31:231"}
{"entryType":"asset-liability","level":"\u001b[32minfo\u001b[39m","message":"\u001b[32m已更新進貨單分錄類型:\u001b[39m","poid":"20250811001","timestamp":"2025-08-11 12:02:31:231"}
{"accounts":[{"id":"6881ede993a4e6567f1de484","index":1,"name":"藥局庫存","type":"asset"},{"id":"688209408961594c0bc0068b","index":2,"name":"嘉鏵","type":"liability"}],"count":2,"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m分析會計科目:\u001b[39m","timestamp":"2025-08-11 12:02:31:231"}
{"creditAccount":"嘉鏵","debitAccount":"藥局庫存","level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m資產-負債格式:\u001b[39m","timestamp":"2025-08-11 12:02:31:231"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m從會計科目推斷機構ID:\u001b[39m","organizationId":"68639ad3d2823bbee3a59e25","timestamp":"2025-08-11 12:02:31:231"}
{"date":"2025-08-10","level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m從進貨單號解析日期:\u001b[39m","poid":"20250811001","timestamp":"2025-08-11 12:02:31:231"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m創建嵌入式交易群組:\u001b[39m","organizationId":"68639ad3d2823bbee3a59e25","timestamp":"2025-08-11 12:02:31:231"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32m成功創建自動會計分錄:\u001b[39m","organizationId":"68639ad3d2823bbee3a59e25","poid":"20250811001","timestamp":"2025-08-11 12:02:31:231"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32m進貨單 20250811001 已關聯交易群組 68996b57d03f5f9ae1ee3edd\u001b[39m","timestamp":"2025-08-11 12:02:31:231"}
{"count":549,"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m批量檢查進貨單付款狀態開始\u001b[39m","timestamp":"2025-08-11 12:02:33:233"}
{"count":549,"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m批量檢查進貨單付款狀態開始\u001b[39m","timestamp":"2025-08-11 12:02:33:233"}
{"hasPaymentCount":92,"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m批量付款狀態檢查完成\u001b[39m","missingPaymentCount":59,"missingTransactionIdCount":398,"paymentTransactionsCount":27,"timestamp":"2025-08-11 12:02:33:233","totalOrders":549}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m批量付款狀態檢查結果\u001b[39m","paidCount":92,"timestamp":"2025-08-11 12:02:33:233","totalCount":549,"unpaidCount":457}
{"hasPaymentCount":92,"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m批量付款狀態檢查完成\u001b[39m","missingPaymentCount":59,"missingTransactionIdCount":398,"paymentTransactionsCount":27,"timestamp":"2025-08-11 12:02:33:233","totalOrders":549}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m批量付款狀態檢查結果\u001b[39m","paidCount":92,"timestamp":"2025-08-11 12:02:33:233","totalCount":549,"unpaidCount":457}
{"count":550,"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m批量檢查進貨單付款狀態開始\u001b[39m","timestamp":"2025-08-11 12:02:34:234"}
{"hasPaymentCount":92,"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m批量付款狀態檢查完成\u001b[39m","missingPaymentCount":60,"missingTransactionIdCount":398,"paymentTransactionsCount":27,"timestamp":"2025-08-11 12:02:34:234","totalOrders":550}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m批量付款狀態檢查結果\u001b[39m","paidCount":92,"timestamp":"2025-08-11 12:02:34:234","totalCount":550,"unpaidCount":458}
{"count":550,"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m批量檢查進貨單付款狀態開始\u001b[39m","timestamp":"2025-08-11 12:02:34:234"}
{"hasPaymentCount":92,"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m批量付款狀態檢查完成\u001b[39m","missingPaymentCount":60,"missingTransactionIdCount":398,"paymentTransactionsCount":27,"timestamp":"2025-08-11 12:02:34:234","totalOrders":550}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m批量付款狀態檢查結果\u001b[39m","paidCount":92,"timestamp":"2025-08-11 12:02:34:234","totalCount":550,"unpaidCount":458}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m執行科目統計聚合查詢\u001b[39m","timestamp":"2025-08-11 12:03:31:331"}
{"executionTime":"13ms","level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m聚合查詢完成\u001b[39m","resultCount":43,"timestamp":"2025-08-11 12:03:31:331"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m執行科目統計聚合查詢\u001b[39m","timestamp":"2025-08-11 12:03:31:331"}
{"executionTime":"6ms","level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m聚合查詢完成\u001b[39m","resultCount":43,"timestamp":"2025-08-11 12:03:31:331"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m執行科目統計聚合查詢\u001b[39m","timestamp":"2025-08-11 12:03:31:331"}
{"executionTime":"6ms","level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m聚合查詢完成\u001b[39m","resultCount":43,"timestamp":"2025-08-11 12:03:31:331"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m執行科目統計聚合查詢\u001b[39m","timestamp":"2025-08-11 12:03:31:331"}
{"executionTime":"6ms","level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m聚合查詢完成\u001b[39m","resultCount":43,"timestamp":"2025-08-11 12:03:31:331"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m檢查產品ID: 67eb60d00f2cf9d2647e3ca8, 名稱: LOPEDIN 2MG 易必寧膠囊\u001b[39m","timestamp":"2025-08-11 12:15:41:1541"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到 14 個庫存記錄\u001b[39m","timestamp":"2025-08-11 12:15:41:1541"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 67ff11298cd383dad08f2fd6, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:15:41:1541"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 6814807f430068b88ebed5bc, 類型: ship, 數量: -3000\u001b[39m","timestamp":"2025-08-11 12:15:41:1541"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 683659809e3abfee6c6548a8, 類型: ship, 數量: -1000\u001b[39m","timestamp":"2025-08-11 12:15:41:1541"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 685b4836e6665d7d0af58f0e, 類型: sale, 數量: -100\u001b[39m","timestamp":"2025-08-11 12:15:41:1541"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 685b488ae6665d7d0af596f4, 類型: sale, 數量: -100\u001b[39m","timestamp":"2025-08-11 12:15:41:1541"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 68672d0287107c6d64bcd1d9, 類型: sale, 數量: -100\u001b[39m","timestamp":"2025-08-11 12:15:41:1541"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 687468868ab022663ead30ae, 類型: ship, 數量: -6\u001b[39m","timestamp":"2025-08-11 12:15:41:1541"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688b25b59593bdf46678964d, 類型: sale, 數量: -100\u001b[39m","timestamp":"2025-08-11 12:15:41:1541"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688e17f50c1f4a3e0f2ad627, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:15:41:1541"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688f3ce2c942f3edf6fc1b63, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:15:41:1541"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688f76c050daca5a7cb94500, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:15:41:1541"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688f778a50daca5a7cb9b27c, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:15:41:1541"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688f780a50daca5a7cba2944, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:15:41:1541"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688f782550daca5a7cba4cf4, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:15:41:1541"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m產品 LOPEDIN 2MG 易必寧膠囊 總庫存量: 2594，銷售數量: 200\u001b[39m","timestamp":"2025-08-11 12:15:41:1541"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m使用前端提供的銷貨單號: \"20250811737\"\u001b[39m","timestamp":"2025-08-11 12:15:41:1541"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m為產品 67eb60d00f2cf9d2647e3ca8 創建銷售庫存記錄，數量: -200, 總金額: 250\u001b[39m","timestamp":"2025-08-11 12:15:41:1541"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到庫存記錄數量: 15\u001b[39m","timestamp":"2025-08-11 12:16:48:1648"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到相關毛利記錄: 1\u001b[39m","timestamp":"2025-08-11 12:16:48:1648"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到庫存記錄數量: 15\u001b[39m","timestamp":"2025-08-11 12:16:48:1648"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到相關毛利記錄: 1\u001b[39m","timestamp":"2025-08-11 12:16:48:1648"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 12:16:50:1650"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 12:16:50:1650"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 12:17:10:1710"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 12:17:10:1710"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32m已刪除 1 個與銷售 20250811737 相關的庫存記錄\u001b[39m","timestamp":"2025-08-11 12:18:51:1851"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m恢復產品 67eb60d00f2cf9d2647e3ca8 的庫存，數量: +200\u001b[39m","timestamp":"2025-08-11 12:18:51:1851"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m檢查產品ID: 67eb60d00f2cf9d2647e3ca8, 名稱: LOPEDIN 2MG 易必寧膠囊\u001b[39m","timestamp":"2025-08-11 12:19:19:1919"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到 14 個庫存記錄\u001b[39m","timestamp":"2025-08-11 12:19:19:1919"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 67ff11298cd383dad08f2fd6, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:19:19:1919"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 6814807f430068b88ebed5bc, 類型: ship, 數量: -3000\u001b[39m","timestamp":"2025-08-11 12:19:19:1919"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 683659809e3abfee6c6548a8, 類型: ship, 數量: -1000\u001b[39m","timestamp":"2025-08-11 12:19:19:1919"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 685b4836e6665d7d0af58f0e, 類型: sale, 數量: -100\u001b[39m","timestamp":"2025-08-11 12:19:19:1919"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 685b488ae6665d7d0af596f4, 類型: sale, 數量: -100\u001b[39m","timestamp":"2025-08-11 12:19:19:1919"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 68672d0287107c6d64bcd1d9, 類型: sale, 數量: -100\u001b[39m","timestamp":"2025-08-11 12:19:19:1919"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 687468868ab022663ead30ae, 類型: ship, 數量: -6\u001b[39m","timestamp":"2025-08-11 12:19:19:1919"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688b25b59593bdf46678964d, 類型: sale, 數量: -100\u001b[39m","timestamp":"2025-08-11 12:19:19:1919"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688e17f50c1f4a3e0f2ad627, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:19:19:1919"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688f3ce2c942f3edf6fc1b63, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:19:19:1919"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688f76c050daca5a7cb94500, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:19:19:1919"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688f778a50daca5a7cb9b27c, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:19:19:1919"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688f780a50daca5a7cba2944, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:19:19:1919"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688f782550daca5a7cba4cf4, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:19:19:1919"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m產品 LOPEDIN 2MG 易必寧膠囊 總庫存量: 2594，銷售數量: 200\u001b[39m","timestamp":"2025-08-11 12:19:19:1919"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m使用前端提供的銷貨單號: \"20250811116\"\u001b[39m","timestamp":"2025-08-11 12:19:19:1919"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m為產品 67eb60d00f2cf9d2647e3ca8 創建銷售庫存記錄，數量: -200, 總金額: 250\u001b[39m","timestamp":"2025-08-11 12:19:19:1919"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32m已刪除 1 個與銷售 20250811116 相關的庫存記錄\u001b[39m","timestamp":"2025-08-11 12:19:45:1945"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m恢復產品 67eb60d00f2cf9d2647e3ca8 的庫存，數量: +200\u001b[39m","timestamp":"2025-08-11 12:19:45:1945"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m檢查產品ID: 67eb60d00f2cf9d2647e3ca8, 名稱: LOPEDIN 2MG 易必寧膠囊\u001b[39m","timestamp":"2025-08-11 12:20:02:202"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到 14 個庫存記錄\u001b[39m","timestamp":"2025-08-11 12:20:02:202"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 67ff11298cd383dad08f2fd6, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:20:02:202"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 6814807f430068b88ebed5bc, 類型: ship, 數量: -3000\u001b[39m","timestamp":"2025-08-11 12:20:02:202"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 683659809e3abfee6c6548a8, 類型: ship, 數量: -1000\u001b[39m","timestamp":"2025-08-11 12:20:02:202"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 685b4836e6665d7d0af58f0e, 類型: sale, 數量: -100\u001b[39m","timestamp":"2025-08-11 12:20:02:202"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 685b488ae6665d7d0af596f4, 類型: sale, 數量: -100\u001b[39m","timestamp":"2025-08-11 12:20:02:202"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 68672d0287107c6d64bcd1d9, 類型: sale, 數量: -100\u001b[39m","timestamp":"2025-08-11 12:20:02:202"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 687468868ab022663ead30ae, 類型: ship, 數量: -6\u001b[39m","timestamp":"2025-08-11 12:20:02:202"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688b25b59593bdf46678964d, 類型: sale, 數量: -100\u001b[39m","timestamp":"2025-08-11 12:20:02:202"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688e17f50c1f4a3e0f2ad627, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:20:02:202"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688f3ce2c942f3edf6fc1b63, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:20:02:202"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688f76c050daca5a7cb94500, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:20:02:202"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688f778a50daca5a7cb9b27c, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:20:02:202"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688f780a50daca5a7cba2944, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:20:02:202"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688f782550daca5a7cba4cf4, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:20:02:202"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m產品 LOPEDIN 2MG 易必寧膠囊 總庫存量: 2594，銷售數量: 200\u001b[39m","timestamp":"2025-08-11 12:20:02:202"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m使用前端提供的銷貨單號: \"20250811340\"\u001b[39m","timestamp":"2025-08-11 12:20:02:202"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m為產品 67eb60d00f2cf9d2647e3ca8 創建銷售庫存記錄，數量: -200, 總金額: 250\u001b[39m","timestamp":"2025-08-11 12:20:02:202"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32m已刪除 1 個與銷售 20250811340 相關的庫存記錄\u001b[39m","timestamp":"2025-08-11 12:20:18:2018"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m恢復產品 67eb60d00f2cf9d2647e3ca8 的庫存，數量: +200\u001b[39m","timestamp":"2025-08-11 12:20:18:2018"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m檢查產品ID: 67eb60d00f2cf9d2647e3ca8, 名稱: LOPEDIN 2MG 易必寧膠囊\u001b[39m","timestamp":"2025-08-11 12:22:04:224"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到 14 個庫存記錄\u001b[39m","timestamp":"2025-08-11 12:22:04:224"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 67ff11298cd383dad08f2fd6, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:22:04:224"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 6814807f430068b88ebed5bc, 類型: ship, 數量: -3000\u001b[39m","timestamp":"2025-08-11 12:22:04:224"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 683659809e3abfee6c6548a8, 類型: ship, 數量: -1000\u001b[39m","timestamp":"2025-08-11 12:22:04:224"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 685b4836e6665d7d0af58f0e, 類型: sale, 數量: -100\u001b[39m","timestamp":"2025-08-11 12:22:04:224"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 685b488ae6665d7d0af596f4, 類型: sale, 數量: -100\u001b[39m","timestamp":"2025-08-11 12:22:04:224"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 68672d0287107c6d64bcd1d9, 類型: sale, 數量: -100\u001b[39m","timestamp":"2025-08-11 12:22:04:224"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 687468868ab022663ead30ae, 類型: ship, 數量: -6\u001b[39m","timestamp":"2025-08-11 12:22:04:224"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688b25b59593bdf46678964d, 類型: sale, 數量: -100\u001b[39m","timestamp":"2025-08-11 12:22:04:224"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688e17f50c1f4a3e0f2ad627, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:22:04:224"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688f3ce2c942f3edf6fc1b63, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:22:04:224"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688f76c050daca5a7cb94500, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:22:04:224"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688f778a50daca5a7cb9b27c, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:22:04:224"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688f780a50daca5a7cba2944, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:22:04:224"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688f782550daca5a7cba4cf4, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:22:04:224"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m產品 LOPEDIN 2MG 易必寧膠囊 總庫存量: 2594，銷售數量: 200\u001b[39m","timestamp":"2025-08-11 12:22:04:224"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m使用前端提供的銷貨單號: \"20250811486\"\u001b[39m","timestamp":"2025-08-11 12:22:04:224"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m為產品 67eb60d00f2cf9d2647e3ca8 創建銷售庫存記錄，數量: -200, 總金額: 250\u001b[39m","timestamp":"2025-08-11 12:22:04:224"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32m已刪除 1 個與銷售 20250811486 相關的庫存記錄\u001b[39m","timestamp":"2025-08-11 12:22:30:2230"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m恢復產品 67eb60d00f2cf9d2647e3ca8 的庫存，數量: +200\u001b[39m","timestamp":"2025-08-11 12:22:30:2230"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m檢查產品ID: 67eb60d00f2cf9d2647e3ca8, 名稱: LOPEDIN 2MG 易必寧膠囊\u001b[39m","timestamp":"2025-08-11 12:22:45:2245"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到 14 個庫存記錄\u001b[39m","timestamp":"2025-08-11 12:22:45:2245"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 67ff11298cd383dad08f2fd6, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:22:45:2245"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 6814807f430068b88ebed5bc, 類型: ship, 數量: -3000\u001b[39m","timestamp":"2025-08-11 12:22:45:2245"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 683659809e3abfee6c6548a8, 類型: ship, 數量: -1000\u001b[39m","timestamp":"2025-08-11 12:22:45:2245"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 685b4836e6665d7d0af58f0e, 類型: sale, 數量: -100\u001b[39m","timestamp":"2025-08-11 12:22:45:2245"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 685b488ae6665d7d0af596f4, 類型: sale, 數量: -100\u001b[39m","timestamp":"2025-08-11 12:22:45:2245"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 68672d0287107c6d64bcd1d9, 類型: sale, 數量: -100\u001b[39m","timestamp":"2025-08-11 12:22:45:2245"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 687468868ab022663ead30ae, 類型: ship, 數量: -6\u001b[39m","timestamp":"2025-08-11 12:22:45:2245"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688b25b59593bdf46678964d, 類型: sale, 數量: -100\u001b[39m","timestamp":"2025-08-11 12:22:45:2245"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688e17f50c1f4a3e0f2ad627, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:22:45:2245"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688f3ce2c942f3edf6fc1b63, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:22:45:2245"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688f76c050daca5a7cb94500, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:22:45:2245"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688f778a50daca5a7cb9b27c, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:22:45:2245"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688f780a50daca5a7cba2944, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:22:45:2245"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688f782550daca5a7cba4cf4, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:22:45:2245"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m產品 LOPEDIN 2MG 易必寧膠囊 總庫存量: 2594，銷售數量: 200\u001b[39m","timestamp":"2025-08-11 12:22:45:2245"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m使用前端提供的銷貨單號: \"20250811442\"\u001b[39m","timestamp":"2025-08-11 12:22:45:2245"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m為產品 67eb60d00f2cf9d2647e3ca8 創建銷售庫存記錄，數量: -200, 總金額: 250\u001b[39m","timestamp":"2025-08-11 12:22:45:2245"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32m已刪除 1 個與銷售 20250811442 相關的庫存記錄\u001b[39m","timestamp":"2025-08-11 12:22:51:2251"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m恢復產品 67eb60d00f2cf9d2647e3ca8 的庫存，數量: +200\u001b[39m","timestamp":"2025-08-11 12:22:51:2251"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m檢查產品ID: 67eb60d00f2cf9d2647e3ca8, 名稱: LOPEDIN 2MG 易必寧膠囊\u001b[39m","timestamp":"2025-08-11 12:25:28:2528"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到 14 個庫存記錄\u001b[39m","timestamp":"2025-08-11 12:25:28:2528"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 67ff11298cd383dad08f2fd6, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:25:28:2528"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 6814807f430068b88ebed5bc, 類型: ship, 數量: -3000\u001b[39m","timestamp":"2025-08-11 12:25:28:2528"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 683659809e3abfee6c6548a8, 類型: ship, 數量: -1000\u001b[39m","timestamp":"2025-08-11 12:25:28:2528"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 685b4836e6665d7d0af58f0e, 類型: sale, 數量: -100\u001b[39m","timestamp":"2025-08-11 12:25:28:2528"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 685b488ae6665d7d0af596f4, 類型: sale, 數量: -100\u001b[39m","timestamp":"2025-08-11 12:25:28:2528"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 68672d0287107c6d64bcd1d9, 類型: sale, 數量: -100\u001b[39m","timestamp":"2025-08-11 12:25:28:2528"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 687468868ab022663ead30ae, 類型: ship, 數量: -6\u001b[39m","timestamp":"2025-08-11 12:25:28:2528"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688b25b59593bdf46678964d, 類型: sale, 數量: -100\u001b[39m","timestamp":"2025-08-11 12:25:28:2528"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688e17f50c1f4a3e0f2ad627, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:25:28:2528"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688f3ce2c942f3edf6fc1b63, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:25:28:2528"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688f76c050daca5a7cb94500, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:25:28:2528"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688f778a50daca5a7cb9b27c, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:25:28:2528"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688f780a50daca5a7cba2944, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:25:28:2528"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688f782550daca5a7cba4cf4, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:25:28:2528"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m產品 LOPEDIN 2MG 易必寧膠囊 總庫存量: 2594，銷售數量: 200\u001b[39m","timestamp":"2025-08-11 12:25:28:2528"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m使用前端提供的銷貨單號: \"20250811968\"\u001b[39m","timestamp":"2025-08-11 12:25:28:2528"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m為產品 67eb60d00f2cf9d2647e3ca8 創建銷售庫存記錄，數量: -200, 總金額: 250\u001b[39m","timestamp":"2025-08-11 12:25:29:2529"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32m已刪除 1 個與銷售 20250811968 相關的庫存記錄\u001b[39m","timestamp":"2025-08-11 12:29:25:2925"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m恢復產品 67eb60d00f2cf9d2647e3ca8 的庫存，數量: +200\u001b[39m","timestamp":"2025-08-11 12:29:25:2925"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m檢查產品ID: 67eb60d00f2cf9d2647e3ca8, 名稱: LOPEDIN 2MG 易必寧膠囊\u001b[39m","timestamp":"2025-08-11 12:29:44:2944"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到 14 個庫存記錄\u001b[39m","timestamp":"2025-08-11 12:29:44:2944"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 67ff11298cd383dad08f2fd6, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:29:44:2944"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 6814807f430068b88ebed5bc, 類型: ship, 數量: -3000\u001b[39m","timestamp":"2025-08-11 12:29:44:2944"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 683659809e3abfee6c6548a8, 類型: ship, 數量: -1000\u001b[39m","timestamp":"2025-08-11 12:29:44:2944"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 685b4836e6665d7d0af58f0e, 類型: sale, 數量: -100\u001b[39m","timestamp":"2025-08-11 12:29:44:2944"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 685b488ae6665d7d0af596f4, 類型: sale, 數量: -100\u001b[39m","timestamp":"2025-08-11 12:29:44:2944"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 68672d0287107c6d64bcd1d9, 類型: sale, 數量: -100\u001b[39m","timestamp":"2025-08-11 12:29:44:2944"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 687468868ab022663ead30ae, 類型: ship, 數量: -6\u001b[39m","timestamp":"2025-08-11 12:29:44:2944"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688b25b59593bdf46678964d, 類型: sale, 數量: -100\u001b[39m","timestamp":"2025-08-11 12:29:44:2944"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688e17f50c1f4a3e0f2ad627, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:29:44:2944"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688f3ce2c942f3edf6fc1b63, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:29:44:2944"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688f76c050daca5a7cb94500, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:29:44:2944"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688f778a50daca5a7cb9b27c, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:29:44:2944"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688f780a50daca5a7cba2944, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:29:44:2944"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688f782550daca5a7cba4cf4, 類型: purchase, 數量: 1000\u001b[39m","timestamp":"2025-08-11 12:29:44:2944"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m產品 LOPEDIN 2MG 易必寧膠囊 總庫存量: 2594，銷售數量: 200\u001b[39m","timestamp":"2025-08-11 12:29:44:2944"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m前端提供了銷貨單號: \"20250811005\"，但將被忽略以確保序號連續性\u001b[39m","timestamp":"2025-08-11 12:29:44:2944"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m由後端生成銷貨單號\u001b[39m","timestamp":"2025-08-11 12:29:44:2944"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m生成日期前綴: 20250811\u001b[39m","timestamp":"2025-08-11 12:29:44:2944"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m查詢當日銷貨單號，日期前綴: 20250811, 正則表達式: ^20250811\\d{3}$\u001b[39m","timestamp":"2025-08-11 12:29:44:2944"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到 5 個匹配的銷貨單號\u001b[39m","timestamp":"2025-08-11 12:29:44:2944"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m所有匹配的銷貨單號: [\"20250811001\",\"20250811242\",\"20250811366\",\"20250811367\",\"20250811368\"]\u001b[39m","timestamp":"2025-08-11 12:29:44:2944"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到當天最後一個銷貨單號: 20250811368\u001b[39m","timestamp":"2025-08-11 12:29:44:2944"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m提取序號: 368, 新序號: 369\u001b[39m","timestamp":"2025-08-11 12:29:44:2944"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m使用數字排序找到的最大序號: 368\u001b[39m","timestamp":"2025-08-11 12:29:44:2944"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m生成銷貨單號: 20250811369\u001b[39m","timestamp":"2025-08-11 12:29:44:2944"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m為產品 67eb60d00f2cf9d2647e3ca8 創建銷售庫存記錄，數量: -200, 總金額: 250\u001b[39m","timestamp":"2025-08-11 12:29:44:2944"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到庫存記錄數量: 107\u001b[39m","timestamp":"2025-08-11 14:18:29:1829"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到相關毛利記錄: 1\u001b[39m","timestamp":"2025-08-11 14:18:29:1829"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到庫存記錄數量: 160\u001b[39m","timestamp":"2025-08-11 14:18:29:1829"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到相關毛利記錄: 1\u001b[39m","timestamp":"2025-08-11 14:18:29:1829"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到庫存記錄數量: 36\u001b[39m","timestamp":"2025-08-11 14:18:29:1829"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到相關毛利記錄: 1\u001b[39m","timestamp":"2025-08-11 14:18:29:1829"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到庫存記錄數量: 44\u001b[39m","timestamp":"2025-08-11 14:18:29:1829"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到相關毛利記錄: 1\u001b[39m","timestamp":"2025-08-11 14:18:29:1829"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到庫存記錄數量: 107\u001b[39m","timestamp":"2025-08-11 14:18:30:1830"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到相關毛利記錄: 1\u001b[39m","timestamp":"2025-08-11 14:18:30:1830"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到庫存記錄數量: 160\u001b[39m","timestamp":"2025-08-11 14:18:30:1830"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到相關毛利記錄: 1\u001b[39m","timestamp":"2025-08-11 14:18:30:1830"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到庫存記錄數量: 36\u001b[39m","timestamp":"2025-08-11 14:18:30:1830"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到相關毛利記錄: 1\u001b[39m","timestamp":"2025-08-11 14:18:30:1830"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到庫存記錄數量: 44\u001b[39m","timestamp":"2025-08-11 14:18:30:1830"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到相關毛利記錄: 1\u001b[39m","timestamp":"2025-08-11 14:18:30:1830"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 14:18:32:1832"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 14:18:32:1832"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 14:18:37:1837"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 14:18:37:1837"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 14:20:14:2014"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 14:20:14:2014"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 14:20:14:2014"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 14:20:14:2014"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 14:20:28:2028"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 14:20:28:2028"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 14:20:28:2028"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 14:20:28:2028"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 14:20:35:2035"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 14:20:35:2035"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 14:20:35:2035"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 14:20:35:2035"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 14:20:38:2038"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 14:20:38:2038"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 14:20:38:2038"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 14:20:38:2038"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m已為產品 67ee330bc047658bac63b62d 創建新庫存記錄，出貨單號: 20250811003, 數量: -2, 總金額: 1810, 類型: ship\u001b[39m","timestamp":"2025-08-11 15:51:56:5156"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32m已成功為出貨單 6899a11c8d9996e1345f7b5c 創建所有ship類型庫存記錄\u001b[39m","timestamp":"2025-08-11 15:51:56:5156"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 15:52:03:523"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 15:52:03:523"}
{"count":550,"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m批量檢查進貨單付款狀態開始\u001b[39m","timestamp":"2025-08-11 15:53:06:536"}
{"hasPaymentCount":92,"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m批量付款狀態檢查完成\u001b[39m","missingPaymentCount":60,"missingTransactionIdCount":398,"paymentTransactionsCount":27,"timestamp":"2025-08-11 15:53:06:536","totalOrders":550}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m批量付款狀態檢查結果\u001b[39m","paidCount":92,"timestamp":"2025-08-11 15:53:06:536","totalCount":550,"unpaidCount":458}
{"count":550,"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m批量檢查進貨單付款狀態開始\u001b[39m","timestamp":"2025-08-11 15:53:17:5317"}
{"count":550,"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m批量檢查進貨單付款狀態開始\u001b[39m","timestamp":"2025-08-11 15:53:17:5317"}
{"hasPaymentCount":92,"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m批量付款狀態檢查完成\u001b[39m","missingPaymentCount":60,"missingTransactionIdCount":398,"paymentTransactionsCount":27,"timestamp":"2025-08-11 15:53:18:5318","totalOrders":550}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m批量付款狀態檢查結果\u001b[39m","paidCount":92,"timestamp":"2025-08-11 15:53:18:5318","totalCount":550,"unpaidCount":458}
{"hasPaymentCount":92,"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m批量付款狀態檢查完成\u001b[39m","missingPaymentCount":60,"missingTransactionIdCount":398,"paymentTransactionsCount":27,"timestamp":"2025-08-11 15:53:18:5318","totalOrders":550}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m批量付款狀態檢查結果\u001b[39m","paidCount":92,"timestamp":"2025-08-11 15:53:18:5318","totalCount":550,"unpaidCount":458}
{"count":550,"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m批量檢查進貨單付款狀態開始\u001b[39m","timestamp":"2025-08-11 15:53:18:5318"}
{"hasPaymentCount":92,"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m批量付款狀態檢查完成\u001b[39m","missingPaymentCount":60,"missingTransactionIdCount":398,"paymentTransactionsCount":27,"timestamp":"2025-08-11 15:53:18:5318","totalOrders":550}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m批量付款狀態檢查結果\u001b[39m","paidCount":92,"timestamp":"2025-08-11 15:53:18:5318","totalCount":550,"unpaidCount":458}
{"count":550,"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m批量檢查進貨單付款狀態開始\u001b[39m","timestamp":"2025-08-11 15:53:18:5318"}
{"hasPaymentCount":92,"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m批量付款狀態檢查完成\u001b[39m","missingPaymentCount":60,"missingTransactionIdCount":398,"paymentTransactionsCount":27,"timestamp":"2025-08-11 15:53:18:5318","totalOrders":550}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m批量付款狀態檢查結果\u001b[39m","paidCount":92,"timestamp":"2025-08-11 15:53:18:5318","totalCount":550,"unpaidCount":458}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 15:53:21:5321"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 15:53:21:5321"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 15:53:50:5350"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 15:53:50:5350"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 15:53:56:5356"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 15:53:56:5356"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 15:54:00:540"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 15:54:00:540"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 15:54:02:542"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 15:54:02:542"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 15:54:05:545"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 15:54:05:545"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 15:54:09:549"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 15:54:09:549"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 15:54:15:5415"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 15:54:15:5415"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 15:54:19:5419"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 15:54:19:5419"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 15:54:26:5426"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 15:54:26:5426"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 16:35:13:3513"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 16:35:13:3513"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m後端序列化後的進貨單資料:\u001b[39m","timestamp":"2025-08-11 16:36:03:363"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m第一個項目的批號:\u001b[39m","timestamp":"2025-08-11 16:36:03:363"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m後端序列化後的進貨單資料:\u001b[39m","timestamp":"2025-08-11 16:36:03:363"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m第一個項目的批號:\u001b[39m","timestamp":"2025-08-11 16:36:03:363"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 16:36:13:3613"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 16:36:13:3613"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m已為產品 686f3fbe3c33f59129db0043 創建新庫存記錄，出貨單號: 20250811004, 數量: -21600, 總金額: 7200, 類型: ship\u001b[39m","timestamp":"2025-08-11 16:43:44:4344"}
{"level":"\u001b[32minfo\u001b[39m","message":"\u001b[32m已成功為出貨單 6899ad408d9996e1345fda35 創建所有ship類型庫存記錄\u001b[39m","timestamp":"2025-08-11 16:43:44:4344"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 16:43:48:4348"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 16:43:48:4348"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m檢查產品ID: 67edfa148b015c0b28783ab9, 名稱: →NEXIUM 40MG 耐適恩\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到 36 個庫存記錄\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 67f2246e9978f61b56e5975b, 類型: purchase, 數量: 28\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 67f3e0e9f362fef30332bd1b, 類型: purchase, 數量: 28\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 67f3fac5f362fef303332895, 類型: purchase, 數量: 28\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 67f8a0c9dc77b2092c188472, 類型: purchase, 數量: 56\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 6808449fa48f04609ed5e185, 類型: purchase, 數量: 84\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 68184e7f3c5f45c598a1956f, 類型: sale, 數量: -28\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 68184eeb3c5f45c598a19cfe, 類型: sale, 數量: -28\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 68184fcf3c5f45c598a19d2c, 類型: sale, 數量: -84\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 681898eb3c5f45c598a312bc, 類型: sale, 數量: -28\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 681bf33b928c5d500fc61a1a, 類型: sale, 數量: -56\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 6820b6be53ecd3eddeef6d49, 類型: purchase, 數量: 56\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 68254d0f53ecd3eddef2fbc3, 類型: purchase, 數量: 56\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 6827f59453ecd3eddef467a2, 類型: sale, 數量: -28\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 6833c3cc0eb9cf19a9bbf71a, 類型: sale, 數量: -28\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 6837dedf5e42dc1361751856, 類型: sale, 數量: -28\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 684262b61489ad43d1faf969, 類型: sale, 數量: -28\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 684c1a5a6a25c8260d45099d, 類型: sale, 數量: -28\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 6850ae07555483ce1455747f, 類型: purchase, 數量: 112\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 6850ae50555483ce1455805d, 類型: sale, 數量: -56\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 6850e509555483ce1455e3f1, 類型: sale, 數量: -28\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 68562fa972394eec183d3ef6, 類型: purchase, 數量: 84\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 685a008ca36e27b4795519ac, 類型: sale, 數量: -28\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 685cb3a4ae952b79a6a0ea47, 類型: sale, 數量: -28\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 6866791a87107c6d64bca6ca, 類型: sale, 數量: -28\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 68761f32ca10b335f76de34a, 類型: sale, 數量: -28\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 687db5fe5d7e991f62c5e3a7, 類型: sale, 數量: -28\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 687e5345f111eca326081656, 類型: sale, 數量: -28\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 687e60a18c26e9fd5934bed9, 類型: ship, 數量: -28\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 68818d839e9da050c1071c2d, 類型: ship, 數量: -28\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 68844f750425a1b526172e37, 類型: sale, 數量: -28\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 6888ad8bd405e8d914b69441, 類型: purchase, 數量: 56\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 6888ae78d405e8d914b6cb8e, 類型: purchase, 數量: 28\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688c12d83dfe49e94df58d23, 類型: purchase, 數量: 112\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688c4a835054d7564b5c4aa1, 類型: purchase, 數量: 56\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 6890755fa2b9045eb2dc9fb4, 類型: sale, 數量: -28\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 689178e6875aeab99471134e, 類型: purchase, 數量: 56\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m產品 →NEXIUM 40MG 耐適恩 總庫存量: 112，銷售數量: 28\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m前端提供了銷貨單號: \"20250811628\"，但將被忽略以確保序號連續性\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m由後端生成銷貨單號\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m生成日期前綴: 20250811\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m查詢當日銷貨單號，日期前綴: 20250811, 正則表達式: ^20250811\\d{3}$\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到 8 個匹配的銷貨單號\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m所有匹配的銷貨單號: [\"20250811001\",\"20250811242\",\"20250811366\",\"20250811367\",\"20250811368\",\"20250811369\",\"20250811370\",\"20250811371\"]\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到當天最後一個銷貨單號: 20250811371\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m提取序號: 371, 新序號: 372\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m使用數字排序找到的最大序號: 371\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m生成銷貨單號: 20250811372\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m為產品 67edfa148b015c0b28783ab9 創建銷售庫存記錄，數量: -28, 總金額: 200\u001b[39m","timestamp":"2025-08-11 17:27:51:2751"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到庫存記錄數量: 37\u001b[39m","timestamp":"2025-08-11 17:27:56:2756"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到相關毛利記錄: 1\u001b[39m","timestamp":"2025-08-11 17:27:56:2756"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到庫存記錄數量: 37\u001b[39m","timestamp":"2025-08-11 17:27:56:2756"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到相關毛利記錄: 1\u001b[39m","timestamp":"2025-08-11 17:27:56:2756"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 17:27:58:2758"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 17:27:58:2758"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 19:59:53:5953"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 19:59:53:5953"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m檢查產品ID: 67ecf2ab0c42503b19a2effd, 名稱: 華淨 幼幼醫用口罩 50片\u001b[39m","timestamp":"2025-08-11 20:04:30:430"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到 8 個庫存記錄\u001b[39m","timestamp":"2025-08-11 20:04:30:430"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 67f3390045c8fe473c56305f, 類型: purchase, 數量: 1\u001b[39m","timestamp":"2025-08-11 20:04:30:430"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 67f3390045c8fe473c563062, 類型: purchase, 數量: 1\u001b[39m","timestamp":"2025-08-11 20:04:30:430"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 67f3888cbabaff09d494d34a, 類型: purchase, 數量: 1\u001b[39m","timestamp":"2025-08-11 20:04:30:430"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 67fe021ec2347c64b939dfa6, 類型: sale, 數量: -1\u001b[39m","timestamp":"2025-08-11 20:04:30:430"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 68591adea36e27b47952124e, 類型: sale, 數量: -2\u001b[39m","timestamp":"2025-08-11 20:04:30:430"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 685e8369620934c0f5e1beb2, 類型: sale, 數量: -2\u001b[39m","timestamp":"2025-08-11 20:04:30:430"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 685ed267620934c0f5e5a4dd, 類型: purchase, 數量: 2\u001b[39m","timestamp":"2025-08-11 20:04:30:430"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 685ed267620934c0f5e5a4e1, 類型: purchase, 數量: 2\u001b[39m","timestamp":"2025-08-11 20:04:30:430"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m產品 華淨 幼幼醫用口罩 50片 總庫存量: 2，銷售數量: 1\u001b[39m","timestamp":"2025-08-11 20:04:30:430"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m前端提供了銷貨單號: \"20250811783\"，但將被忽略以確保序號連續性\u001b[39m","timestamp":"2025-08-11 20:04:30:430"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m由後端生成銷貨單號\u001b[39m","timestamp":"2025-08-11 20:04:30:430"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m生成日期前綴: 20250811\u001b[39m","timestamp":"2025-08-11 20:04:30:430"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m查詢當日銷貨單號，日期前綴: 20250811, 正則表達式: ^20250811\\d{3}$\u001b[39m","timestamp":"2025-08-11 20:04:30:430"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到 12 個匹配的銷貨單號\u001b[39m","timestamp":"2025-08-11 20:04:30:430"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m所有匹配的銷貨單號: [\"20250811001\",\"20250811242\",\"20250811366\",\"20250811367\",\"20250811368\",\"20250811369\",\"20250811370\",\"20250811371\",\"20250811372\",\"20250811373\",\"20250811374\",\"20250811375\"]\u001b[39m","timestamp":"2025-08-11 20:04:30:430"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到當天最後一個銷貨單號: 20250811375\u001b[39m","timestamp":"2025-08-11 20:04:30:430"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m提取序號: 375, 新序號: 376\u001b[39m","timestamp":"2025-08-11 20:04:30:430"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m使用數字排序找到的最大序號: 375\u001b[39m","timestamp":"2025-08-11 20:04:30:430"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m生成銷貨單號: 20250811376\u001b[39m","timestamp":"2025-08-11 20:04:30:430"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m為產品 67ecf2ab0c42503b19a2effd 創建銷售庫存記錄，數量: -1, 總金額: 110\u001b[39m","timestamp":"2025-08-11 20:04:30:430"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m檢查產品ID: 67eb60d00f2cf9d2647e3cf3, 名稱: ☆SINBETA DERM 10G 杏貝他健乳膏\u001b[39m","timestamp":"2025-08-11 20:08:55:855"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到 20 個庫存記錄\u001b[39m","timestamp":"2025-08-11 20:08:55:855"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 67f1564021b3099037ec017c, 類型: purchase, 數量: 5\u001b[39m","timestamp":"2025-08-11 20:08:55:855"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 67f245e7287ee1d68106759b, 類型: purchase, 數量: 10\u001b[39m","timestamp":"2025-08-11 20:08:55:855"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 67f24caf287ee1d68106bc03, 類型: purchase, 數量: 20\u001b[39m","timestamp":"2025-08-11 20:08:55:855"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 67f24d47287ee1d68106c576, 類型: purchase, 數量: 10\u001b[39m","timestamp":"2025-08-11 20:08:55:855"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 67f24f51287ee1d68106d974, 類型: purchase, 數量: 40\u001b[39m","timestamp":"2025-08-11 20:08:55:855"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 67f347698f21c94bafa636aa, 類型: purchase, 數量: 10\u001b[39m","timestamp":"2025-08-11 20:08:55:855"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 67f3bd43f362fef30330cb04, 類型: purchase, 數量: 144\u001b[39m","timestamp":"2025-08-11 20:08:55:855"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 67fdf8fac2347c64b939896f, 類型: sale, 數量: -2\u001b[39m","timestamp":"2025-08-11 20:08:55:855"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 680e644175dfd9ef546d6c82, 類型: ship, 數量: -194\u001b[39m","timestamp":"2025-08-11 20:08:55:855"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 6814b66baab47ed5b01fc2d4, 類型: sale, 數量: -3\u001b[39m","timestamp":"2025-08-11 20:08:55:855"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 6814b771aab47ed5b01fce70, 類型: ship, 數量: -103\u001b[39m","timestamp":"2025-08-11 20:08:55:855"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 682b10f153ecd3eddef6988b, 類型: sale, 數量: -4\u001b[39m","timestamp":"2025-08-11 20:08:55:855"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 6846ce201489ad43d1fea9c0, 類型: sale, 數量: -1\u001b[39m","timestamp":"2025-08-11 20:08:55:855"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 684ab6a7f17605379eb421d5, 類型: purchase, 數量: 144\u001b[39m","timestamp":"2025-08-11 20:08:55:855"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 687468868ab022663ead30b1, 類型: ship, 數量: -1\u001b[39m","timestamp":"2025-08-11 20:08:55:855"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 6877afe981c63e995c3dfd72, 類型: purchase, 數量: 144\u001b[39m","timestamp":"2025-08-11 20:08:55:855"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688353129f2a9036ce118855, 類型: ship, 數量: -1\u001b[39m","timestamp":"2025-08-11 20:08:55:855"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688c37133dfe49e94dfa3200, 類型: purchase, 數量: 6\u001b[39m","timestamp":"2025-08-11 20:08:55:855"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688c40661d950d8bcafda8cd, 類型: purchase, 數量: 5\u001b[39m","timestamp":"2025-08-11 20:08:55:855"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m庫存記錄: 688deb32b49e502707093942, 類型: purchase, 數量: 2\u001b[39m","timestamp":"2025-08-11 20:08:55:855"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m產品 ☆SINBETA DERM 10G 杏貝他健乳膏 總庫存量: 231，銷售數量: 2\u001b[39m","timestamp":"2025-08-11 20:08:55:855"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m前端提供了銷貨單號: \"20250811930\"，但將被忽略以確保序號連續性\u001b[39m","timestamp":"2025-08-11 20:08:55:855"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m由後端生成銷貨單號\u001b[39m","timestamp":"2025-08-11 20:08:55:855"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m生成日期前綴: 20250811\u001b[39m","timestamp":"2025-08-11 20:08:55:855"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m查詢當日銷貨單號，日期前綴: 20250811, 正則表達式: ^20250811\\d{3}$\u001b[39m","timestamp":"2025-08-11 20:08:55:855"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到 13 個匹配的銷貨單號\u001b[39m","timestamp":"2025-08-11 20:08:55:855"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m所有匹配的銷貨單號: [\"20250811001\",\"20250811242\",\"20250811366\",\"20250811367\",\"20250811368\",\"20250811369\",\"20250811370\",\"20250811371\",\"20250811372\",\"20250811373\",\"20250811374\",\"20250811375\",\"20250811376\"]\u001b[39m","timestamp":"2025-08-11 20:08:55:855"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到當天最後一個銷貨單號: 20250811376\u001b[39m","timestamp":"2025-08-11 20:08:55:855"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m提取序號: 376, 新序號: 377\u001b[39m","timestamp":"2025-08-11 20:08:55:855"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m使用數字排序找到的最大序號: 376\u001b[39m","timestamp":"2025-08-11 20:08:55:855"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m生成銷貨單號: 20250811377\u001b[39m","timestamp":"2025-08-11 20:08:55:855"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m為產品 67eb60d00f2cf9d2647e3cf3 創建銷售庫存記錄，數量: -2, 總金額: 60\u001b[39m","timestamp":"2025-08-11 20:08:55:855"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到庫存記錄數量: 21\u001b[39m","timestamp":"2025-08-11 20:15:28:1528"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到相關毛利記錄: 1\u001b[39m","timestamp":"2025-08-11 20:15:28:1528"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到庫存記錄數量: 21\u001b[39m","timestamp":"2025-08-11 20:15:28:1528"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m找到相關毛利記錄: 1\u001b[39m","timestamp":"2025-08-11 20:15:28:1528"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 20:15:30:1530"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 20:15:30:1530"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 20:15:53:1553"}
{"level":"\u001b[37mdebug\u001b[39m","message":"\u001b[37m一般產品 FIFO 計算完成\u001b[39m","timestamp":"2025-08-11 20:15:53:1553"}
{"level":"\u001b[33mwarn\u001b[39m","message":"\u001b[33m產品 測試產品 庫存不足，當前總庫存: 1，需求: 5，將允許負庫存\u001b[39m","timestamp":"2025-08-11 22:51:48:5148"}
{"level":"\u001b[31merror\u001b[39m","message":"\u001b[31m創建銷售記錄錯誤: Database connection failed\u001b[39m","timestamp":"2025-08-11 22:51:50:5150"}
{"error":"Database error","level":"\u001b[31merror\u001b[39m","message":"\u001b[31m建立交易錯誤\u001b[39m","timestamp":"2025-08-11 22:52:21:5221"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'建立交易群組錯誤: 交易群組編號 TXN001 已存在'\u001b[39m","stack":"Error: 交易群組編號 TXN001 已存在\n    at Function.createTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:35:17)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:102:7)","timestamp":"2025-08-11 22:52:31:5231"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'取得交易群組詳細資料錯誤: 交易群組不存在或無權限存取'\u001b[39m","stack":"Error: 交易群組不存在或無權限存取\n    at Function.getTransactionGroupById (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:162:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:235:7)","timestamp":"2025-08-11 22:52:31:5231"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'更新交易群組錯誤: 交易群組不存在或無權限存取'\u001b[39m","stack":"Error: 交易群組不存在或無權限存取\n    at Function.updateTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:221:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:333:7)","timestamp":"2025-08-11 22:52:31:5231"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'更新交易群組錯誤: 已確認的交易無法修改'\u001b[39m","stack":"Error: 已確認的交易無法修改\n    at Function.updateTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:226:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:344:7)","timestamp":"2025-08-11 22:52:31:5231"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'更新交易群組錯誤: 交易群組編號 NEW001 已存在'\u001b[39m","stack":"Error: 交易群組編號 NEW001 已存在\n    at Function.updateTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:238:17)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:358:7)","timestamp":"2025-08-11 22:52:31:5231"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'確認交易群組錯誤: 交易群組不存在或無權限存取'\u001b[39m","stack":"Error: 交易群組不存在或無權限存取\n    at Function.confirmTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:286:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:402:7)","timestamp":"2025-08-11 22:52:31:5231"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'確認交易群組錯誤: 交易群組已經確認'\u001b[39m","stack":"Error: 交易群組已經確認\n    at Function.confirmTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:290:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:413:7)","timestamp":"2025-08-11 22:52:31:5231"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'確認交易群組錯誤: 已取消的交易無法確認'\u001b[39m","stack":"Error: 已取消的交易無法確認\n    at Function.confirmTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:294:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:424:7)","timestamp":"2025-08-11 22:52:31:5231"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'確認交易群組錯誤: 交易群組必須包含分錄才能確認'\u001b[39m","stack":"Error: 交易群組必須包含分錄才能確認\n    at Function.confirmTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:299:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:439:7)","timestamp":"2025-08-11 22:52:31:5231"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'確認交易群組錯誤: 交易借貸不平衡：借方 1000，貸方 500'\u001b[39m","stack":"Error: 交易借貸不平衡：借方 1000，貸方 500\n    at Function.confirmTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:307:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:457:7)","timestamp":"2025-08-11 22:52:31:5231"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'取消交易群組錯誤: 交易群組不存在或無權限存取'\u001b[39m","stack":"Error: 交易群組不存在或無權限存取\n    at Function.cancelTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:352:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:495:7)","timestamp":"2025-08-11 22:52:31:5231"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'取消交易群組錯誤: 交易群組已經取消'\u001b[39m","stack":"Error: 交易群組已經取消\n    at Function.cancelTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:356:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:506:7)","timestamp":"2025-08-11 22:52:31:5231"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'取消交易群組錯誤: 無法取消交易：有 2 筆交易引用此交易'\u001b[39m","stack":"Error: 無法取消交易：有 2 筆交易引用此交易\n    at Function.cancelTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:367:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:520:7)","timestamp":"2025-08-11 22:52:31:5231"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'計算交易餘額錯誤: 交易不存在、未確認或無權限存取'\u001b[39m","stack":"Error: 交易不存在、未確認或無權限存取\n    at Function.calculateTransactionBalance (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:501:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:570:7)","timestamp":"2025-08-11 22:52:31:5231"}
{"existingAccountIds":[],"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'缺少的科目 ID:'\u001b[39m","missingAccountIds":["nonexistent"],"queryConditions":{"uniqueAccountIds":["nonexistent"],"userId":"user123"},"timestamp":"2025-08-11 22:52:31:5231"}
{"entryType":"invalid-format","level":"\u001b[33m'warn'\u001b[39m","message":"\u001b[33m'不支援的分錄類型:'\u001b[39m","timestamp":"2025-08-11 22:52:50:5250"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'創建自動會計分錄時發生錯誤: 部分會計科目不存在'\u001b[39m","stack":"Error: 部分會計科目不存在\n    at Function.getAccountDetails (D:\\pharmacy-pos\\backend\\services\\AutoAccountingEntryService.ts:210:13)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Function.handlePurchaseOrderCompletion (D:\\pharmacy-pos\\backend\\services\\AutoAccountingEntryService.ts:30:24)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\__tests__\\AutoAccountingEntryService.test.ts:241:7)","timestamp":"2025-08-11 22:52:50:5250"}
{"entryType":"expense-asset","level":"\u001b[33m'warn'\u001b[39m","message":"\u001b[33m'無法根據分錄格式找到合適的借貸科目:'\u001b[39m","timestamp":"2025-08-11 22:52:50:5250"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'建立交易群組錯誤: 交易群組編號 TXN001 已存在'\u001b[39m","stack":"Error: 交易群組編號 TXN001 已存在\n    at Function.createTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:35:17)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:102:7)","timestamp":"2025-08-11 23:05:32:532"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'取得交易群組詳細資料錯誤: 交易群組不存在或無權限存取'\u001b[39m","stack":"Error: 交易群組不存在或無權限存取\n    at Function.getTransactionGroupById (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:162:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:235:7)","timestamp":"2025-08-11 23:05:32:532"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'更新交易群組錯誤: 交易群組不存在或無權限存取'\u001b[39m","stack":"Error: 交易群組不存在或無權限存取\n    at Function.updateTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:221:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:333:7)","timestamp":"2025-08-11 23:05:32:532"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'更新交易群組錯誤: 已確認的交易無法修改'\u001b[39m","stack":"Error: 已確認的交易無法修改\n    at Function.updateTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:226:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:344:7)","timestamp":"2025-08-11 23:05:32:532"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'更新交易群組錯誤: 交易群組編號 NEW001 已存在'\u001b[39m","stack":"Error: 交易群組編號 NEW001 已存在\n    at Function.updateTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:238:17)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:358:7)","timestamp":"2025-08-11 23:05:32:532"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'確認交易群組錯誤: 交易群組不存在或無權限存取'\u001b[39m","stack":"Error: 交易群組不存在或無權限存取\n    at Function.confirmTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:286:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:402:7)","timestamp":"2025-08-11 23:05:32:532"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'確認交易群組錯誤: 交易群組已經確認'\u001b[39m","stack":"Error: 交易群組已經確認\n    at Function.confirmTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:290:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:413:7)","timestamp":"2025-08-11 23:05:32:532"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'確認交易群組錯誤: 已取消的交易無法確認'\u001b[39m","stack":"Error: 已取消的交易無法確認\n    at Function.confirmTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:294:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:424:7)","timestamp":"2025-08-11 23:05:32:532"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'確認交易群組錯誤: 交易群組必須包含分錄才能確認'\u001b[39m","stack":"Error: 交易群組必須包含分錄才能確認\n    at Function.confirmTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:299:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:439:7)","timestamp":"2025-08-11 23:05:32:532"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'確認交易群組錯誤: 交易借貸不平衡：借方 1000，貸方 500'\u001b[39m","stack":"Error: 交易借貸不平衡：借方 1000，貸方 500\n    at Function.confirmTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:307:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:457:7)","timestamp":"2025-08-11 23:05:32:532"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'取消交易群組錯誤: 交易群組不存在或無權限存取'\u001b[39m","stack":"Error: 交易群組不存在或無權限存取\n    at Function.cancelTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:352:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:495:7)","timestamp":"2025-08-11 23:05:32:532"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'取消交易群組錯誤: 交易群組已經取消'\u001b[39m","stack":"Error: 交易群組已經取消\n    at Function.cancelTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:356:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:506:7)","timestamp":"2025-08-11 23:05:32:532"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'取消交易群組錯誤: 無法取消交易：有 2 筆交易引用此交易'\u001b[39m","stack":"Error: 無法取消交易：有 2 筆交易引用此交易\n    at Function.cancelTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:367:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:520:7)","timestamp":"2025-08-11 23:05:32:532"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'計算交易餘額錯誤: 交易不存在、未確認或無權限存取'\u001b[39m","stack":"Error: 交易不存在、未確認或無權限存取\n    at Function.calculateTransactionBalance (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:501:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:570:7)","timestamp":"2025-08-11 23:05:32:532"}
{"existingAccountIds":[],"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'缺少的科目 ID:'\u001b[39m","missingAccountIds":["nonexistent"],"queryConditions":{"uniqueAccountIds":["nonexistent"],"userId":"user123"},"timestamp":"2025-08-11 23:05:32:532"}
{"level":"\u001b[33mwarn\u001b[39m","message":"\u001b[33m產品 測試產品 庫存不足，當前總庫存: 1，需求: 5，將允許負庫存\u001b[39m","timestamp":"2025-08-11 23:05:43:543"}
{"level":"\u001b[31merror\u001b[39m","message":"\u001b[31m創建銷售記錄錯誤: Database connection failed\u001b[39m","timestamp":"2025-08-11 23:05:44:544"}
{"entryType":"invalid-format","level":"\u001b[33m'warn'\u001b[39m","message":"\u001b[33m'不支援的分錄類型:'\u001b[39m","timestamp":"2025-08-11 23:06:26:626"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'創建自動會計分錄時發生錯誤: 部分會計科目不存在'\u001b[39m","stack":"Error: 部分會計科目不存在\n    at Function.getAccountDetails (D:\\pharmacy-pos\\backend\\services\\AutoAccountingEntryService.ts:210:13)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Function.handlePurchaseOrderCompletion (D:\\pharmacy-pos\\backend\\services\\AutoAccountingEntryService.ts:30:24)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\__tests__\\AutoAccountingEntryService.test.ts:241:7)","timestamp":"2025-08-11 23:06:26:626"}
{"entryType":"expense-asset","level":"\u001b[33m'warn'\u001b[39m","message":"\u001b[33m'無法根據分錄格式找到合適的借貸科目:'\u001b[39m","timestamp":"2025-08-11 23:06:26:626"}
{"error":"Database error","level":"\u001b[31merror\u001b[39m","message":"\u001b[31m建立交易錯誤\u001b[39m","timestamp":"2025-08-11 23:06:32:632"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'建立交易群組錯誤: 交易群組編號 TXN001 已存在'\u001b[39m","stack":"Error: 交易群組編號 TXN001 已存在\n    at Function.createTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:35:17)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:102:7)","timestamp":"2025-08-11 23:13:02:132"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'取得交易群組詳細資料錯誤: 交易群組不存在或無權限存取'\u001b[39m","stack":"Error: 交易群組不存在或無權限存取\n    at Function.getTransactionGroupById (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:162:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:235:7)","timestamp":"2025-08-11 23:13:02:132"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'更新交易群組錯誤: 交易群組不存在或無權限存取'\u001b[39m","stack":"Error: 交易群組不存在或無權限存取\n    at Function.updateTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:221:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:333:7)","timestamp":"2025-08-11 23:13:02:132"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'更新交易群組錯誤: 已確認的交易無法修改'\u001b[39m","stack":"Error: 已確認的交易無法修改\n    at Function.updateTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:226:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:344:7)","timestamp":"2025-08-11 23:13:02:132"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'更新交易群組錯誤: 交易群組編號 NEW001 已存在'\u001b[39m","stack":"Error: 交易群組編號 NEW001 已存在\n    at Function.updateTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:238:17)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:358:7)","timestamp":"2025-08-11 23:13:03:133"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'確認交易群組錯誤: 交易群組不存在或無權限存取'\u001b[39m","stack":"Error: 交易群組不存在或無權限存取\n    at Function.confirmTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:286:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:402:7)","timestamp":"2025-08-11 23:13:03:133"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'確認交易群組錯誤: 交易群組已經確認'\u001b[39m","stack":"Error: 交易群組已經確認\n    at Function.confirmTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:290:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:413:7)","timestamp":"2025-08-11 23:13:03:133"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'確認交易群組錯誤: 已取消的交易無法確認'\u001b[39m","stack":"Error: 已取消的交易無法確認\n    at Function.confirmTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:294:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:424:7)","timestamp":"2025-08-11 23:13:03:133"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'確認交易群組錯誤: 交易群組必須包含分錄才能確認'\u001b[39m","stack":"Error: 交易群組必須包含分錄才能確認\n    at Function.confirmTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:299:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:439:7)","timestamp":"2025-08-11 23:13:03:133"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'確認交易群組錯誤: 交易借貸不平衡：借方 1000，貸方 500'\u001b[39m","stack":"Error: 交易借貸不平衡：借方 1000，貸方 500\n    at Function.confirmTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:307:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:457:7)","timestamp":"2025-08-11 23:13:03:133"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'取消交易群組錯誤: 交易群組不存在或無權限存取'\u001b[39m","stack":"Error: 交易群組不存在或無權限存取\n    at Function.cancelTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:352:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:495:7)","timestamp":"2025-08-11 23:13:03:133"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'取消交易群組錯誤: 交易群組已經取消'\u001b[39m","stack":"Error: 交易群組已經取消\n    at Function.cancelTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:356:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:506:7)","timestamp":"2025-08-11 23:13:03:133"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'取消交易群組錯誤: 無法取消交易：有 2 筆交易引用此交易'\u001b[39m","stack":"Error: 無法取消交易：有 2 筆交易引用此交易\n    at Function.cancelTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:367:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:520:7)","timestamp":"2025-08-11 23:13:03:133"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'計算交易餘額錯誤: 交易不存在、未確認或無權限存取'\u001b[39m","stack":"Error: 交易不存在、未確認或無權限存取\n    at Function.calculateTransactionBalance (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:501:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:570:7)","timestamp":"2025-08-11 23:13:03:133"}
{"existingAccountIds":[],"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'缺少的科目 ID:'\u001b[39m","missingAccountIds":["nonexistent"],"queryConditions":{"uniqueAccountIds":["nonexistent"],"userId":"user123"},"timestamp":"2025-08-11 23:13:03:133"}
{"level":"\u001b[33mwarn\u001b[39m","message":"\u001b[33m產品 測試產品 庫存不足，當前總庫存: 1，需求: 5，將允許負庫存\u001b[39m","timestamp":"2025-08-11 23:13:17:1317"}
{"level":"\u001b[31merror\u001b[39m","message":"\u001b[31m創建銷售記錄錯誤: Database connection failed\u001b[39m","timestamp":"2025-08-11 23:13:18:1318"}
{"entryType":"invalid-format","level":"\u001b[33m'warn'\u001b[39m","message":"\u001b[33m'不支援的分錄類型:'\u001b[39m","timestamp":"2025-08-11 23:13:57:1357"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'創建自動會計分錄時發生錯誤: 部分會計科目不存在'\u001b[39m","stack":"Error: 部分會計科目不存在\n    at Function.getAccountDetails (D:\\pharmacy-pos\\backend\\services\\AutoAccountingEntryService.ts:210:13)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Function.handlePurchaseOrderCompletion (D:\\pharmacy-pos\\backend\\services\\AutoAccountingEntryService.ts:30:24)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\__tests__\\AutoAccountingEntryService.test.ts:241:7)","timestamp":"2025-08-11 23:13:57:1357"}
{"entryType":"expense-asset","level":"\u001b[33m'warn'\u001b[39m","message":"\u001b[33m'無法根據分錄格式找到合適的借貸科目:'\u001b[39m","timestamp":"2025-08-11 23:13:57:1357"}
{"error":"Database error","level":"\u001b[31merror\u001b[39m","message":"\u001b[31m建立交易錯誤\u001b[39m","timestamp":"2025-08-11 23:14:02:142"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'建立交易群組錯誤: 交易群組編號 TXN001 已存在'\u001b[39m","stack":"Error: 交易群組編號 TXN001 已存在\n    at Function.createTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:35:17)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:102:7)","timestamp":"2025-08-11 23:28:00:280"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'取得交易群組詳細資料錯誤: 交易群組不存在或無權限存取'\u001b[39m","stack":"Error: 交易群組不存在或無權限存取\n    at Function.getTransactionGroupById (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:162:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:235:7)","timestamp":"2025-08-11 23:28:00:280"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'更新交易群組錯誤: 交易群組不存在或無權限存取'\u001b[39m","stack":"Error: 交易群組不存在或無權限存取\n    at Function.updateTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:221:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:333:7)","timestamp":"2025-08-11 23:28:00:280"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'更新交易群組錯誤: 已確認的交易無法修改'\u001b[39m","stack":"Error: 已確認的交易無法修改\n    at Function.updateTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:226:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:344:7)","timestamp":"2025-08-11 23:28:00:280"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'更新交易群組錯誤: 交易群組編號 NEW001 已存在'\u001b[39m","stack":"Error: 交易群組編號 NEW001 已存在\n    at Function.updateTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:238:17)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:358:7)","timestamp":"2025-08-11 23:28:00:280"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'確認交易群組錯誤: 交易群組不存在或無權限存取'\u001b[39m","stack":"Error: 交易群組不存在或無權限存取\n    at Function.confirmTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:286:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:402:7)","timestamp":"2025-08-11 23:28:00:280"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'確認交易群組錯誤: 交易群組已經確認'\u001b[39m","stack":"Error: 交易群組已經確認\n    at Function.confirmTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:290:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:413:7)","timestamp":"2025-08-11 23:28:00:280"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'確認交易群組錯誤: 已取消的交易無法確認'\u001b[39m","stack":"Error: 已取消的交易無法確認\n    at Function.confirmTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:294:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:424:7)","timestamp":"2025-08-11 23:28:00:280"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'確認交易群組錯誤: 交易群組必須包含分錄才能確認'\u001b[39m","stack":"Error: 交易群組必須包含分錄才能確認\n    at Function.confirmTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:299:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:439:7)","timestamp":"2025-08-11 23:28:00:280"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'確認交易群組錯誤: 交易借貸不平衡：借方 1000，貸方 500'\u001b[39m","stack":"Error: 交易借貸不平衡：借方 1000，貸方 500\n    at Function.confirmTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:307:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:457:7)","timestamp":"2025-08-11 23:28:00:280"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'取消交易群組錯誤: 交易群組不存在或無權限存取'\u001b[39m","stack":"Error: 交易群組不存在或無權限存取\n    at Function.cancelTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:352:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:495:7)","timestamp":"2025-08-11 23:28:00:280"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'取消交易群組錯誤: 交易群組已經取消'\u001b[39m","stack":"Error: 交易群組已經取消\n    at Function.cancelTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:356:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:506:7)","timestamp":"2025-08-11 23:28:00:280"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'取消交易群組錯誤: 無法取消交易：有 2 筆交易引用此交易'\u001b[39m","stack":"Error: 無法取消交易：有 2 筆交易引用此交易\n    at Function.cancelTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:367:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:520:7)","timestamp":"2025-08-11 23:28:00:280"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'計算交易餘額錯誤: 交易不存在、未確認或無權限存取'\u001b[39m","stack":"Error: 交易不存在、未確認或無權限存取\n    at Function.calculateTransactionBalance (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:501:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:570:7)","timestamp":"2025-08-11 23:28:00:280"}
{"existingAccountIds":[],"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'缺少的科目 ID:'\u001b[39m","missingAccountIds":["nonexistent"],"queryConditions":{"uniqueAccountIds":["nonexistent"],"userId":"user123"},"timestamp":"2025-08-11 23:28:00:280"}
{"level":"\u001b[33mwarn\u001b[39m","message":"\u001b[33m產品 測試產品 庫存不足，當前總庫存: 1，需求: 5，將允許負庫存\u001b[39m","timestamp":"2025-08-11 23:28:15:2815"}
{"level":"\u001b[31merror\u001b[39m","message":"\u001b[31m創建銷售記錄錯誤: Database connection failed\u001b[39m","timestamp":"2025-08-11 23:28:16:2816"}
{"entryType":"invalid-format","level":"\u001b[33m'warn'\u001b[39m","message":"\u001b[33m'不支援的分錄類型:'\u001b[39m","timestamp":"2025-08-11 23:29:14:2914"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'創建自動會計分錄時發生錯誤: 部分會計科目不存在'\u001b[39m","stack":"Error: 部分會計科目不存在\n    at Function.getAccountDetails (D:\\pharmacy-pos\\backend\\services\\AutoAccountingEntryService.ts:210:13)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Function.handlePurchaseOrderCompletion (D:\\pharmacy-pos\\backend\\services\\AutoAccountingEntryService.ts:30:24)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\__tests__\\AutoAccountingEntryService.test.ts:241:7)","timestamp":"2025-08-11 23:29:15:2915"}
{"entryType":"expense-asset","level":"\u001b[33m'warn'\u001b[39m","message":"\u001b[33m'無法根據分錄格式找到合適的借貸科目:'\u001b[39m","timestamp":"2025-08-11 23:29:15:2915"}
{"error":"Database error","level":"\u001b[31merror\u001b[39m","message":"\u001b[31m建立交易錯誤\u001b[39m","timestamp":"2025-08-11 23:29:18:2918"}
{"level":"\u001b[33mwarn\u001b[39m","message":"\u001b[33m產品 測試產品 庫存不足，當前總庫存: 1，需求: 5，將允許負庫存\u001b[39m","timestamp":"2025-08-12 00:15:26:1526"}
{"level":"\u001b[31merror\u001b[39m","message":"\u001b[31m創建銷售記錄錯誤: Database connection failed\u001b[39m","timestamp":"2025-08-12 00:15:27:1527"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'建立交易群組錯誤: 交易群組編號 TXN001 已存在'\u001b[39m","stack":"Error: 交易群組編號 TXN001 已存在\n    at Function.createTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:35:17)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:102:7)","timestamp":"2025-08-12 00:15:59:1559"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'取得交易群組詳細資料錯誤: 交易群組不存在或無權限存取'\u001b[39m","stack":"Error: 交易群組不存在或無權限存取\n    at Function.getTransactionGroupById (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:162:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:235:7)","timestamp":"2025-08-12 00:15:59:1559"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'更新交易群組錯誤: 交易群組不存在或無權限存取'\u001b[39m","stack":"Error: 交易群組不存在或無權限存取\n    at Function.updateTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:221:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:333:7)","timestamp":"2025-08-12 00:15:59:1559"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'更新交易群組錯誤: 已確認的交易無法修改'\u001b[39m","stack":"Error: 已確認的交易無法修改\n    at Function.updateTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:226:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:344:7)","timestamp":"2025-08-12 00:15:59:1559"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'更新交易群組錯誤: 交易群組編號 NEW001 已存在'\u001b[39m","stack":"Error: 交易群組編號 NEW001 已存在\n    at Function.updateTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:238:17)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:358:7)","timestamp":"2025-08-12 00:15:59:1559"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'確認交易群組錯誤: 交易群組不存在或無權限存取'\u001b[39m","stack":"Error: 交易群組不存在或無權限存取\n    at Function.confirmTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:286:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:402:7)","timestamp":"2025-08-12 00:15:59:1559"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'確認交易群組錯誤: 交易群組已經確認'\u001b[39m","stack":"Error: 交易群組已經確認\n    at Function.confirmTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:290:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:413:7)","timestamp":"2025-08-12 00:15:59:1559"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'確認交易群組錯誤: 已取消的交易無法確認'\u001b[39m","stack":"Error: 已取消的交易無法確認\n    at Function.confirmTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:294:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:424:7)","timestamp":"2025-08-12 00:15:59:1559"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'確認交易群組錯誤: 交易群組必須包含分錄才能確認'\u001b[39m","stack":"Error: 交易群組必須包含分錄才能確認\n    at Function.confirmTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:299:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:439:7)","timestamp":"2025-08-12 00:15:59:1559"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'確認交易群組錯誤: 交易借貸不平衡：借方 1000，貸方 500'\u001b[39m","stack":"Error: 交易借貸不平衡：借方 1000，貸方 500\n    at Function.confirmTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:307:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:457:7)","timestamp":"2025-08-12 00:15:59:1559"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'取消交易群組錯誤: 交易群組不存在或無權限存取'\u001b[39m","stack":"Error: 交易群組不存在或無權限存取\n    at Function.cancelTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:352:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:495:7)","timestamp":"2025-08-12 00:15:59:1559"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'取消交易群組錯誤: 交易群組已經取消'\u001b[39m","stack":"Error: 交易群組已經取消\n    at Function.cancelTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:356:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:506:7)","timestamp":"2025-08-12 00:15:59:1559"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'取消交易群組錯誤: 無法取消交易：有 2 筆交易引用此交易'\u001b[39m","stack":"Error: 無法取消交易：有 2 筆交易引用此交易\n    at Function.cancelTransactionGroup (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:367:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:520:7)","timestamp":"2025-08-12 00:15:59:1559"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'計算交易餘額錯誤: 交易不存在、未確認或無權限存取'\u001b[39m","stack":"Error: 交易不存在、未確認或無權限存取\n    at Function.calculateTransactionBalance (D:\\pharmacy-pos\\backend\\services\\accounting2\\TransactionService.ts:501:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\accounting2\\__tests__\\TransactionService.test.ts:570:7)","timestamp":"2025-08-12 00:15:59:1559"}
{"existingAccountIds":[],"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'缺少的科目 ID:'\u001b[39m","missingAccountIds":["nonexistent"],"queryConditions":{"uniqueAccountIds":["nonexistent"],"userId":"user123"},"timestamp":"2025-08-12 00:15:59:1559"}
{"entryType":"invalid-format","level":"\u001b[33m'warn'\u001b[39m","message":"\u001b[33m'不支援的分錄類型:'\u001b[39m","timestamp":"2025-08-12 00:16:05:165"}
{"level":"\u001b[31m'error'\u001b[39m","message":"\u001b[31m'創建自動會計分錄時發生錯誤: 部分會計科目不存在'\u001b[39m","stack":"Error: 部分會計科目不存在\n    at Function.getAccountDetails (D:\\pharmacy-pos\\backend\\services\\AutoAccountingEntryService.ts:210:13)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Function.handlePurchaseOrderCompletion (D:\\pharmacy-pos\\backend\\services\\AutoAccountingEntryService.ts:30:24)\n    at Object.<anonymous> (D:\\pharmacy-pos\\backend\\services\\__tests__\\AutoAccountingEntryService.test.ts:241:7)","timestamp":"2025-08-12 00:16:05:165"}
{"entryType":"expense-asset","level":"\u001b[33m'warn'\u001b[39m","message":"\u001b[33m'無法根據分錄格式找到合適的借貸科目:'\u001b[39m","timestamp":"2025-08-12 00:16:05:165"}
{"error":"Database error","level":"\u001b[31merror\u001b[39m","message":"\u001b[31m建立交易錯誤\u001b[39m","timestamp":"2025-08-12 00:16:13:1613"}
